function displayItems() {
    const container = document.getElementById("rss-feed-list");
    if (!container) {
        console.error("RSS container not found!");
        return;
    }
    allItems = shuffleArray(allItems).slice(0, 8);
    const redIndices = [];
    while (redIndices.length < 4 && redIndices.length < allItems.length) {
        const idx = Math.floor(Math.random() * allItems.length);
        if (!redIndices.includes(idx)) redIndices.push(idx);
    }
    const badgeIndices = [];
    const badgeCount = Math.floor(Math.random() * 5);
    while (badgeIndices.length < badgeCount && badgeIndices.length < redIndices.length) {
        const idx = redIndices[Math.floor(Math.random() * redIndices.length)];
        if (!badgeIndices.includes(idx)) badgeIndices.push(idx);
    }
    container.innerHTML = "";
    allItems.forEach((item, i) => {
        const li = document.createElement("li"),
              a = document.createElement("a");
        a.href = item.link;
        a.textContent = item.title;
        a.target = "_blank";
        if (redIndices.includes(i)) {
            a.className = "red";
            if (badgeIndices.includes(i)) {
                const badge = document.createElement("span");
                badge.textContent = "新着";
                badge.className = "new-badge";
                li.appendChild(badge);
            }
        }
        li.appendChild(a);
        container.appendChild(li);
    });
    // 高さに余裕を追加
    window.parent.postMessage({
        height: document.body.scrollHeight + 20 // 20px余裕
    }, "*");
}
